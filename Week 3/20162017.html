<!doctype html>
<html>
    <head>
		<title>Temperatures of 1984</title>
	</head>
	<body>
		<textarea id="rawdata">
		#date,maxtemp
		  20160701,   22
		  20160702,   15
		  20160703,  178
		  20160704,    0
		  20160705,   19
		  20160706,    5
		  20160707,    0
		  20160708,   47
		  20160709,    0
		  20160710,    0
		  20160711,    0
		  20160712,   99
		  20160713,   42
		  20160714,    0
		  20160715,    0
		  20160716,    0
		  20160717,   -1
		  20160718,    0
		  20160719,    0
		  20160720,    0
		  20160721,    0
		  20160722,  117
		  20160723,    0
		  20160724,    0
		  20160725,    5
		  20160726,    0
		  20160727,   64
		  20160728,    5
		  20160729,   38
		  20160730,   72
		  20160731,    2
		  20160801,   68
		  20160802,   83
		  20160803,   19
		  20160804,   -1
		  20160805,    0
		  20160806,   64
		  20160807,    0
		  20160808,    1
		  20160809,   74
		  20160810,   13
		  20160811,   96
		  20160812,   16
		  20160813,    0
		  20160814,    0
		  20160815,    0
		  20160816,    0
		  20160817,    0
		  20160818,    0
		  20160819,   34
		  20160820,   54
		  20160821,  145
		  20160822,   32
		  20160823,    0
		  20160824,    0
		  20160825,    0
		  20160826,    0
		  20160827,   11
		  20160828,    4
		  20160829,    2
		  20160830,    0
		  20160831,    0
		  20160901,    0
		  20160902,   10
		  20160903,   10
		  20160904,   28
		  20160905,   -1
		  20160906,    0
		  20160907,    0
		  20160908,    0
		  20160909,    0
		  20160910,    0
		  20160911,   12
		  20160912,    0
		  20160913,    0
		  20160914,    0
		  20160915,   42
		  20160916,   12
		  20160917,    0
		  20160918,    0
		  20160919,    0
		  20160920,    0
		  20160921,    0
		  20160922,    0
		  20160923,   -1
		  20160924,    0
		  20160925,   35
		  20160926,    0
		  20160927,    0
		  20160928,   -1
		  20160929,   27
		  20160930,   -1
		  20161001,   10
		  20161002,  107
		  20161003,   -1
		  20161004,    0
		  20161005,    0
		  20161006,    0
		  20161007,    0
		  20161008,   -1
		  20161009,    4
		  20161010,    0
		  20161011,   -1
		  20161012,    0
		  20161013,    0
		  20161014,   47
		  20161015,   41
		  20161016,   -1
		  20161017,    2
		  20161018,  117
		  20161019,  134
		  20161020,    9
		  20161021,    2
		  20161022,    0
		  20161023,    0
		  20161024,    0
		  20161025,    0
		  20161026,   -1
		  20161027,    0
		  20161028,   -1
		  20161029,    0
		  20161030,    0
		  20161031,    0
		  20161101,    2
		  20161102,   42
		  20161103,    6
		  20161104,   27
		  20161105,   31
		  20161106,   51
		  20161107,   17
		  20161108,   15
		  20161109,   37
		  20161110,  139
		  20161111,    2
		  20161112,    8
		  20161113,   17
		  20161114,   39
		  20161115,   35
		  20161116,   56
		  20161117,  120
		  20161118,    7
		  20161119,   -1
		  20161120,   46
		  20161121,   49
		  20161122,    0
		  20161123,    0
		  20161124,    0
		  20161125,    0
		  20161126,    0
		  20161127,   -1
		  20161128,    0
		  20161129,    0
		  20161130,    0
		  20161201,   -1
		  20161202,    9
		  20161203,    0
		  20161204,    0
		  20161205,    0
		  20161206,    0
		  20161207,    0
		  20161208,    1
		  20161209,    0
		  20161210,   49
		  20161211,   17
		  20161212,    0
		  20161213,    1
		  20161214,    0
		  20161215,    0
		  20161216,    0
		  20161217,   -1
		  20161218,    0
		  20161219,    0
		  20161220,    0
		  20161221,   24
		  20161222,   15
		  20161223,    8
		  20161224,   10
		  20161225,    5
		  20161226,   19
		  20161227,   11
		  20161228,    0
		  20161229,   -1
		  20161230,   -1
		  20161231,    2
		  20170101,   19
		  20170102,    5
		  20170103,    7
		  20170104,   18
		  20170105,   -1
		  20170106,    0
		  20170107,   52
		  20170108,    0
		  20170109,   48
		  20170110,   38
		  20170111,    5
		  20170112,  143
		  20170113,   96
		  20170114,   51
		  20170115,    0
		  20170116,   -1
		  20170117,    0
		  20170118,   -1
		  20170119,    0
		  20170120,    0
		  20170121,    0
		  20170122,    0
		  20170123,   -1
		  20170124,    3
		  20170125,    0
		  20170126,    0
		  20170127,    0
		  20170128,   -1
		  20170129,   36
		  20170130,   65
		  20170131,    0
		  20170201,   12
		  20170202,   10
		  20170203,    1
		  20170204,   83
		  20170205,   -1
		  20170206,    0
		  20170207,   25
		  20170208,    2
		  20170209,   -1
		  20170210,    2
		  20170211,   45
		  20170212,    3
		  20170213,    0
		  20170214,    0
		  20170215,   -1
		  20170216,    5
		  20170217,    6
		  20170218,    0
		  20170219,    6
		  20170220,   53
		  20170221,    3
		  20170222,  175
		  20170223,  145
		  20170224,    6
		  20170225,    7
		  20170226,   21
		  20170227,  138
		  20170228,   28
		  20170301,   35
		  20170302,   84
		  20170303,   11
		  20170304,   61
		  20170305,   38
		  20170306,   23
		  20170307,    1
		  20170308,  137
		  20170309,    1
		  20170310,    0
		  20170311,    0
		  20170312,    0
		  20170313,    0
		  20170314,    0
		  20170315,    0
		  20170316,    0
		  20170317,   57
		  20170318,   62
		  20170319,    2
		  20170320,   94
		  20170321,   -1
		  20170322,    0
		  20170323,    0
		  20170324,    0
		  20170325,    0
		  20170326,    0
		  20170327,    0
		  20170328,    1
		  20170329,   -1
		  20170330,    0
		  20170331,   14
		  20170401,   -1
		  20170402,    0
		  20170403,    0
		  20170404,    0
		  20170405,    0
		  20170406,   -1
		  20170407,    0
		  20170408,    0
		  20170409,    0
		  20170410,    0
		  20170411,    0
		  20170412,    8
		  20170413,   -1
		  20170414,   -1
		  20170415,   34
		  20170416,   29
		  20170417,   86
		  20170418,   -1
		  20170419,    0
		  20170420,    0
		  20170421,    8
		  20170422,    6
		  20170423,    1
		  20170424,   27
		  20170425,   20
		  20170426,    3
		  20170427,    2
		  20170428,   19
		  20170429,   -1
		  20170430,    0
		  20170501,    9
		  20170502,   47
		  20170503,   35
		  20170504,   -1
		  20170505,   -1
		  20170506,    0
		  20170507,    0
		  20170508,   -1
		  20170509,    0
		  20170510,    0
		  20170511,    3
		  20170512,  125
		  20170513,  100
		  20170514,   19
		  20170515,   -1
		  20170516,   -1
		  20170517,    0
		  20170518,    3
		  20170519,    1
		  20170520,   12
		  20170521,    0
		  20170522,    0
		  20170523,    0
		  20170524,    0
		  20170525,    0
		  20170526,    0
		  20170527,    0
		  20170528,    0
		  20170529,    3
		  20170530,    0
		  20170531,    0
		  20170601,    0
		  20170602,    0
		  20170603,   21
		  20170604,    0
		  20170605,    0
		  20170606,  105
		  20170607,   51
		  20170608,    3
		  20170609,  212
		  20170610,    0
		  20170611,   -1
		  20170612,   -1
		  20170613,    0
		  20170614,    0
		  20170615,    0
		  20170616,    0
		  20170617,    0
		  20170618,    0
		  20170619,    0
		  20170620,    0
		  20170621,    0
		  20170622,   13
		  20170623,    0
		  20170624,   55
		  20170625,   46
		  20170626,    0
		  20170627,   28
		  20170628,   31
		  20170629,    1
		  20170630,   42
		</textarea>
    </body>
	<h1>
	<script>
	// Acquires the raw data
	var link = document.getElementById("rawdata");

	// Splits the raw data
	var link = document.getElementById("rawdata").value;
	var splitted = (link).split("\n");
	
	var length = splitted.length;
	var len = length - 1;
	
	// Initializes the variables
	X = [];
	Y = [];
	miliseconds = [];
	days = [];
	before = 441673200000;
	
	// Cuts the splitted data into two arrays of time and temperature
	// Changes the times to dates, miliseconds and days. 
	// Changes the temperature strings to integers.
	for (var i = 1; i < (len); i++)
	{
		var chunks = splitted[i].split(",");
		X[i] = chunks[0];
		Y[i] = chunks[1];
		Y[i] = +Y[i];
		Y[i] = Y[i] / 10;
		X[i] = new Date((X[i]).replace(
		/(\d\d\d\d)(\d\d)(\d\d)/, '$2-$3-$1'));
		miliseconds[i] = X[i].getTime();
		miliseconds[i] = miliseconds[i] - before;
		days[i] = miliseconds[i] / (1000*60*60*24);
	}
	console.log(miliseconds);
	console.log(days);
	console.log(Y);
	console.log(X);
	
	// Calculates the max and min values of the rain array
	var rainmax = 0;
	var rainmin = 0;
	for (var counter = 0; counter < len; counter++) {
		if (Y[counter] > rainmax)
			rainmax = Y[counter];
		if (Y[counter] < rainmin)
			rainmin = Y[counter];
	}
	
	</script>
	<canvas id="myCanvas" width="1500" height="800"></canvas>
    <script> "use strict"
	
	// Sets the name and frame of the canvas
	var canvas = document.getElementById('myCanvas');
	var context = canvas.getContext('2d');
	context.font = '48px serif';
	context.fillText('Average montly amount of Rain in De Bilt (NL)', 100, 50);
	
	// Sets the dimensions of the graph.
	var Xmax = 1300;
	var XMin = 100;
	var YMin = 700;
	var YMax = 100;
	
	// Draws the Y-axis
	context.beginPath();
    context.moveTo(XMin, YMax);
    context.lineTo(XMin, YMin);
    context.stroke();
	
	// Draws the X-axis
	context.beginPath();
    context.moveTo(YMax, YMin);
    context.lineTo(Xmax, YMin);
    context.stroke();
	
	// Draws the Text
	context.font = '18px serif';
	context.fillText('2016', 1310, 710);
	context.font = '15px serif';
	context.fillText('Rain in mm', 20, 80);

	// Creates arrays for the month clicks and temperature clicks
	var clicks = [0, 31, 62, 92, 123, 153, 184, 215, 243, 274, 304, 335, 365];
	var months = ["July", "Augustus", "September", "October", "November", "December", 
	"January", "February", "March", "April", "May", "June", ""];
	var rains = [rainmin, 0, 5, 10, 15, 20, rainmax]
	
	// Transforms the datapoints to coordinates within range of the canvas
	var xaxis = createTransform([days[1], days[366]], [100, 1300]);
	var yaxis = createTransform([rainmax, rainmin], [100, 700]);
	
	// Draws the graph of temperature against time
	for (var j = 0; j < (len); j++){
		context.beginPath();
		context.moveTo(xaxis(j), yaxis(Y[j]));
		context.lineTo(xaxis(j+1), yaxis(Y[j+1]));
		context.stroke();
    }

	// draws the clicks and text on the Y and X-axis
	for (var y = 0; y < 7; y++){
		context.beginPath();
		context.moveTo(100, yaxis(rains[y]));
		context.lineTo(90, yaxis(rains[y]));
		context.stroke();
		context.font = '12px serif';
		context.fillText(rains[y], 65, yaxis(rains[y]));
    }

	for (var x = 0; x < 13; x++){
		context.beginPath();
		context.moveTo(xaxis(clicks[x]), 700);
		context.lineTo(xaxis(clicks[x]), 710);
		context.stroke();
		context.font = '18px serif';
		context.fillText(months[x], xaxis(clicks[x]), 725);
    }

	function createTransform(domain, range){
		// domain is a two-element array of the data bounds [domain_min, domain_max]
		// range is a two-element array of the screen bounds [range_min, range_max]
		// this gives you two equations to solve:
		// range_min = alpha * domain_min + beta
		// range_max = alpha * domain_max + beta
			// a solution would be:

		var domain_min = domain[0]
		var domain_max = domain[1]
		var range_min = range[0]
		var range_max = range[1]

		// formulas to calculate the alpha and the beta
		var alpha = (range_max - range_min) / (domain_max - domain_min)
		var beta = range_max - alpha * domain_max

		// returns the function for the linear transformation (y= a * x + b)
		return function(x){
		  return alpha * x + beta;
		}
	}
	 
	</script>
</html>